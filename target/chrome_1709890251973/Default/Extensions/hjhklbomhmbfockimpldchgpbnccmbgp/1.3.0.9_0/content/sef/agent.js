'use strict';(function(e){function n(h,l=!1){try{let b="";if(!document.getElementById("sef_banner")){const c=document.createElement("div");c.id="sef_banner";c.innerText="";c.classList.add("sef_banner_class");const d=document.createElement("style");d.innerText="body .sef_banner_class {background: rgb(49, 48, 42, 0.9);font-family: Helvetica;position: fixed;width: -webkit-fill-available;z-index: 999;font-size: small;}";document.body.prepend(d,c);b='<span style="float: right;background: orange;border-radius: 5px;border: 2px solid orange;border-spacing: 5px;padding-right: 6px;padding-left: 6px;margin-left: 2px;margin-right: 2px;" onclick="document.getElementById(\'sef_banner\').style.display=\'none\'">Do not show</span><span style="float: right;background: orange;border-radius: 5px;border: 2px solid orange;border-spacing: 5px;padding-right: 6px;padding-left: 6px;margin-left: 2px;margin-right: 2px;" onclick="document.body.removeChild(document.getElementById(\'sef_banner\'))">Dismiss</span>'}const m=
document.getElementById("sef_banner"),a="<span style='color:#dddddd'>"+`<img style="height: 16px; weight: 16px" src="${f.extension.getURL("icon.png")}">${h}</span>${b}<br>`;m.innerHTML=!0===l?m.innerHTML+a:a}catch(b){console.error(`SEFAgent: Unable to add banner: ${b}`)}}let f;try{f=e.browser||e.chrome||e.safari}catch(h){f=e.a}let g=null;(e.SEFAgent=e.SEFAgent||{}).browserObject=f;e.SEFAgent.utils={AddBanner:n};e.SEFAgent._1="1.0// @ifndef karma";e.SEF=function(){function h(a,...c){try{if(0===this.b.length||
this.b.includes(null))return null;if(!g)throw Error("Port not connected");const d=new b;g.postMessage({invoke:a,chain:this.b,params:c,cookie:d.cookie,objectId:this.f});return d.a}catch(d){return Promise.reject(d)}finally{this.b=[]}}function l(a=null){return{get:function(c,d,k){"string"===typeof d&&this.b.push(d);return k},set:function(c,d,k){return c.bind(this)("set",d,k)},construct:function(c,d){return new m(c.bind(this)("new",...d))},apply:function(c,d,k){return c.bind(this)("call",...k)},b:[],
f:a}}class b{constructor(a=5){this.a=new Promise((c,d)=>{this.resolve=c;this.reject=d});this.cookie=b.c();this.a.finally(()=>{b.a.delete(this.cookie)});a&&setTimeout(()=>{this.reject("timeout")},1E3*a);b.a.set(this.cookie,this)}static c(){return Infinity===++b.cookie?b.cookie=1:b.cookie}}b.cookie=0;b.a=new Map;g=f.runtime.connect({name:"agent"});g.onDisconnect.addListener(a=>{g=null;b.a.clear();console.log(`Disconnected from remote: ${a.error||f.h.g}`)});g.onMessage.addListener(a=>{if(a.cookie&&b.a.has(a.cookie))a.error?
b.a.get(a.cookie).reject(Error(`[${a.cookie}]${a.error}`)):b.a.get(a.cookie).resolve(a.result);else if(a.command)switch(a.command){case "banner":n(a.params,a.append)}else console.warn(`cmd: <${a.command}> cookie: <${a.cookie}> `+`outstanding: ${b.a.has(a.cookie)}`)});class m{constructor(a){this.future=a;this.future.then(c=>{this.proxy=new Proxy(h,new l(c))}).catch(()=>{})}["OnInitComplete"](){return this.future}}return new Proxy(h,new l)}();e.SEFAgent._1="// @endif";e.SEFAgent._2=void 0})(this);
